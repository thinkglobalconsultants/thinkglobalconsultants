---
type Tab = {
  id: string;
  icon?: string;      // emoji o texto corto
  label: string;      // School Leadership
  sublabel?: string;  // Heads, principals, board
  title: string;      // Cohesive culture, smoother operations
  body: string;       // Descripción larga

};

const {
  heading = "Who It Transforms",
  subheading = "The program reaches every layer of your school community.",
  tabs = [
    {
      id: "leadership",
      icon: School,
      label: "School Leadership",
      sublabel: "Heads, principals, board",
      title: "Aligned vision, sharper decisions",
      body:
        "School leaders navigating a multicultural community need more than good intentions — they need a shared framework for understanding how culture shapes priorities, communication, and expectations across the board.",
    },
    {
      id: "teachers",
      icon: Teacher,
      label: "Teachers",
      sublabel: "Classroom & specialist faculty",
      title: "Confidence in every classroom",
      body:
        "Teachers in multicultural schools face invisible friction daily — students and families who interpret authority, feedback, and participation through completely different cultural lenses. CQ gives teachers the tools to read the room and adapt.",
    },
    {
      id: "parents",
      icon: Parents,
      label: "Parents",
      sublabel: "Family engagement & support",
      title: "Connection, not confusion",
      body:
        "Parents from diverse backgrounds often feel excluded — not because schools don't care, but because engagement models assume shared cultural norms. CQ helps parents understand the school's approach and feel genuinely welcomed.",
    },
    {
      id: "staff",
      icon: Heart,
      label: "Staff & Support",
      sublabel: "Admin, counselors, operations",
      title: "Cohesive culture, smoother operations",
      body:
        "Support staff, counselors, and admin teams are often the first point of contact for families — and the most overlooked in cultural training. CQ equips them to navigate sensitive interactions with skill and empathy.",
    },
  ],
  defaultId = tabs[0]?.id,
} = Astro.props as {
  heading?: string;
  subheading?: string;
  tabs?: Tab[];
  defaultId?: string;
};

import { Image } from 'astro:assets';
import Heart from '~/assets/Icons/Heart.svg';
import School from '~/assets/Icons/School.svg';
import Teacher from '~/assets/Icons/Teacher.svg';
import Parents from '~/assets/Icons/Parent.svg';
---

<section class="mx-auto w-full max-w-6xl px-4 py-12 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="mx-auto max-w-2xl text-center">
    <h2 class="text-4xl font-semibold tracking-tight text-balance text-[#3C788C] sm:text-5xl">
      {heading}
    </h2>
    {subheading && <p class="mt-3 text-base text-gray-600 sm:text-lg">{subheading}</p>}
  </div>

  <!-- Card -->
  <div
    class="mt-10 overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-sm"
    data-vertical-tabs
  >
    <div class="grid grid-cols-1 md:grid-cols-2">
      <!-- Left: Tabs -->
      <div class="border-b border-gray-200 bg-white md:border-b-0 md:border-r md:border-gray-200">
        <div
          class="p-3 sm:p-4"
          role="tablist"
          aria-label="Vertical tabs"
        >
          {tabs.map((t) => (
            <button
              type="button"
              class="vt-tab group flex w-full items-start gap-3 rounded-xl p-4 text-left transition
                     hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-600"
              role="tab"
              id={`tab-${t.id}`}
              aria-controls={`panel-${t.id}`}
              aria-selected={t.id === defaultId ? "true" : "false"}
              data-tab={t.id}
              data-active={t.id === defaultId ? "true" : "false"}
            >
              
              {t.icon && (
                <Image
                  src={t.icon}
                  alt={t.label}
                  class="h-6 w-6 flex-none rounded-lg bg-gray-50 group-data-[active=true]:bg-white"
                />
              )}
             
              <span class="min-w-0">
                <span class="block text-sm font-semibold text-gray-900">
                  {t.label}
                </span>
                {t.sublabel && (
                  <span class="mt-0.5 block text-xs text-gray-500">
                    {t.sublabel}
                  </span>
                )}
              </span>
            </button>
          ))}
        </div>
      </div>

      <!-- Right: Panel -->
      <div class="bg-white p-6 sm:p-8">
        {tabs.map((t) => (
          <div
            class="vt-panel"
            role="tabpanel"
            id={`panel-${t.id}`}
            aria-labelledby={`tab-${t.id}`}
            data-panel={t.id}
            hidden={t.id !== defaultId}
          >
            <h3 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">
              {t.title}
            </h3>

            <p class="mt-4 max-w-prose text-sm leading-7 text-gray-600 sm:text-base">
              {t.body}
            </p>

          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  /* Estado activo (sin depender de plugins) */
  [data-vertical-tabs] .vt-tab[data-active="true"]{
    background: rgb(249 250 251); /* gray-50 */
    box-shadow: inset 0 0 0 1px rgb(243 244 246); /* gray-100 */
  }
</style>

<script is:inline>
  (() => {
    const root = document.currentScript?.previousElementSibling?.querySelector?.("[data-vertical-tabs]");
    if (!root) return;

    const tabs = Array.from(root.querySelectorAll("[data-tab]"));
    const panels = Array.from(root.querySelectorAll("[data-panel]"));

    const setActive = (id) => {
      tabs.forEach((btn) => {
        const isActive = btn.dataset.tab === id;
        btn.dataset.active = isActive ? "true" : "false";
        btn.setAttribute("aria-selected", isActive ? "true" : "false");
        btn.tabIndex = isActive ? 0 : -1;
      });

      panels.forEach((panel) => {
        panel.hidden = panel.dataset.panel !== id;
      });
    };

    tabs.forEach((btn) => {
      btn.addEventListener("click", () => setActive(btn.dataset.tab));
    });

    // Teclado: ↑ ↓ Home End
    root.addEventListener("keydown", (e) => {
      const keys = ["ArrowUp", "ArrowDown", "Home", "End"];
      if (!keys.includes(e.key)) return;

      const currentIndex = tabs.findIndex((t) => t.getAttribute("aria-selected") === "true");
      let nextIndex = currentIndex;

      if (e.key === "ArrowUp") nextIndex = (currentIndex - 1 + tabs.length) % tabs.length;
      if (e.key === "ArrowDown") nextIndex = (currentIndex + 1) % tabs.length;
      if (e.key === "Home") nextIndex = 0;
      if (e.key === "End") nextIndex = tabs.length - 1;

      const next = tabs[nextIndex];
      if (next) {
        setActive(next.dataset.tab);
        next.focus();
        e.preventDefault();
      }
    });
  })();
</script>
